<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RubiksWord</title>
  <style>
    /* ... [Your CSS remains unchanged] ... */
  </style>
</head>
<body>
  <h1>RubiksWord!</h1>
  <p>The grid below contains five 5-letter words horizontally.</p>
  <p>Use the arrows to rotate rows and columns!<br>
  <strong>Puzzle is solved when every row is a valid word. Columns do not need to be words.</strong></p>
  <div class="center-container">
    <div class="game-container" id="game"></div>
    <p id="moves">Moves: 0</p>
    <button class="btn" id="newGameBtn">New Game</button>
  </div>

  <script>
    const words = [/* ... your word list ... */];

    const wordColors = ["#e74c3c", "#f1c40f", "#2ecc71", "#3498db", "#9b59b6"];
    function pickRandomWords(wordList, count) {
      const shuffled = [...wordList].sort(() => Math.random() - 0.5);
      return shuffled.slice(0, count);
    }

    let selectedWords = pickRandomWords(words, 5);
    let originalGrid = selectedWords.map(w => w.split(""));
    let grid = JSON.parse(JSON.stringify(originalGrid));
    let moves = 0;

    let originRows = Array.from({length: 5}, (_, r) => Array(5).fill(r));

    function rotateRowRightScramble(row) {
      const last = grid[row][4];
      const lastOrigin = originRows[row][4];
      for (let i = 4; i > 0; i--) {
        grid[row][i] = grid[row][i - 1];
        originRows[row][i] = originRows[row][i - 1];
      }
      grid[row][0] = last;
      originRows[row][0] = lastOrigin;
    }

    function rotateRowLeftScramble(row) {
      const first = grid[row][0];
      const firstOrigin = originRows[row][0];
      for (let i = 0; i < 4; i++) {
        grid[row][i] = grid[row][i + 1];
        originRows[row][i] = originRows[row][i + 1];
      }
      grid[row][4] = first;
      originRows[row][4] = firstOrigin;
    }

    function rotateColDownScramble(col) {
      const last = grid[4][col];
      const lastOrigin = originRows[4][col];
      for (let i = 4; i > 0; i--) {
        grid[i][col] = grid[i - 1][col];
        originRows[i][col] = originRows[i - 1][col];
      }
      grid[0][col] = last;
      originRows[0][col] = lastOrigin;
    }

    function rotateColUpScramble(col) {
      const first = grid[0][col];
      const firstOrigin = originRows[0][col];
      for (let i = 0; i < 4; i++) {
        grid[i][col] = grid[i + 1][col];
        originRows[i][col] = originRows[i + 1][col];
      }
      grid[4][col] = first;
      originRows[4][col] = firstOrigin;
    }

    function scramble() {
      selectedWords = pickRandomWords(words, 5);
      originalGrid = selectedWords.map(w => w.split(""));
      grid = JSON.parse(JSON.stringify(originalGrid));
      originRows = Array.from({length: 5}, (_, r) => Array(5).fill(r));
      for (let i = 0; i < 15; i++) {
        const r = Math.floor(Math.random() * 5);
        const c = Math.floor(Math.random() * 5);
        if (Math.random() > 0.5) {
          rotateRowRightScramble(r);
        } else {
          rotateRowLeftScramble(r);
        }
        if (Math.random() > 0.5) {
          rotateColDownScramble(c);
        } else {
          rotateColUpScramble(c);
        }
      }
      moves = 0;
      update();
    }

    function rotateRowRight(row) {
      const last = grid[row][4];
      const lastOrigin = originRows[row][4];
      for (let i = 4; i > 0; i--) {
        grid[row][i] = grid[row][i - 1];
        originRows[row][i] = originRows[row][i - 1];
      }
      grid[row][0] = last;
      originRows[row][0] = lastOrigin;
      moves++;
    }

    function rotateRowLeft(row) {
      const first = grid[row][0];
      const firstOrigin = originRows[row][0];
      for (let i = 0; i < 4; i++) {
        grid[row][i] = grid[row][i + 1];
        originRows[row][i] = originRows[row][i + 1];
      }
      grid[row][4] = first;
      originRows[row][4] = firstOrigin;
      moves++;
    }

    function rotateColDown(col) {
      const last = grid[4][col];
      const lastOrigin = originRows[4][col];
      for (let i = 4; i > 0; i--) {
        grid[i][col] = grid[i - 1][col];
        originRows[i][col] = originRows[i - 1][col];
      }
      grid[0][col] = last;
      originRows[0][col] = lastOrigin;
      moves++;
    }

    function rotateColUp(col) {
      const first = grid[0][col];
      const firstOrigin = originRows[0][col];
      for (let i = 0; i < 4; i++) {
        grid[i][col] = grid[i + 1][col];
        originRows[i][col] = originRows[i + 1][col];
      }
      grid[4][col] = first;
      originRows[4][col] = firstOrigin;
      moves++;
    }

    function animateRow(row, direction) {
      const cells = document.querySelectorAll(`.cell[data-row='${row}']`);
      cells.forEach(cell => {
        cell.classList.add(direction === "right" ? "slide-right" : "slide-left");
      });
      setTimeout(() => {
        if (direction === "right") {
          rotateRowRight(row);
        } else {
          rotateRowLeft(row);
        }
        update();
      }, 300);
    }
    function animateCol(col, direction) {
      const cells = document.querySelectorAll(`.cell[data-col='${col}']`);
      cells.forEach(cell => {
        cell.classList.add(direction === "down" ? "slide-down" : "slide-up");
      });
      setTimeout(() => {
        if (direction === "down") {
          rotateColDown(col);
        } else {
          rotateColUp(col);
        }
        update();
      }, 300);
    }

    function createGrid() {
      game.innerHTML = "";
      for (let row = 0; row < 7; row++) {
        for (let col = 0; col < 7; col++) {
          if (row === 0 && col >= 1 && col <= 5) {
            addButton("↑", () => animateCol(col - 1, "up"));
          } else if (row === 6 && col >= 1 && col <= 5) {
            addButton("↓", () => animateCol(col - 1, "down"));
          } else if (col === 0 && row >= 1 && row <= 5) {
            addButton("←", () => animateRow(row - 1, "left"), wordColors[row - 1]);
          } else if (col === 6 && row >= 1 && row <= 5) {
            addButton("→", () => animateRow(row - 1, "right"), wordColors[row - 1]);
          } else if (row >= 1 && row <= 5 && col >= 1 && col <= 5) {
            const div = document.createElement("div");
            div.className = "cell";
            div.dataset.row = row - 1;
            div.dataset.col = col - 1;
            const char = grid[row - 1][col - 1];
            div.textContent = char;
            const colorIdx = originRows[row - 1][col - 1];
            const bgColor = wordColors[colorIdx];
            div.style.backgroundColor = bgColor;
            div.style.color = (bgColor === "#f1c40f") ? "#222" : "white";
            div.style.border = "2px solid #555";
            game.appendChild(div);
          } else {
            const div = document.createElement("div");
            div.className = "cell empty";
            game.appendChild(div);
          }
        }
      }
    }

    function addButton(symbol, action, color) {
      const btn = document.createElement("button");
      btn.className = "btn";
      btn.textContent = symbol;
      btn.onclick = action;
      if (color) {
        btn.style.backgroundColor = color;
        if (color === "#f1c40f") btn.style.color = "#222";
        else btn.style.color = "white";
      }
      game.appendChild(btn);
    }

    function update() {
      createGrid();
      movesEl.textContent = `Moves: ${moves}`;
      checkWin();
    }

    function checkWin() {
      // Win if every row forms a valid word (columns don't matter)
      let allRowsAreWords = true;
      for (let i = 0; i < 5; i++) {
        const rowWord = grid[i].join("").toUpperCase();
        if (!words.includes(rowWord)) {
          allRowsAreWords = false;
          break;
        }
      }
      if (allRowsAreWords) {
        let feedback = "";
        if (moves < 100)
          feedback = "You are a GENIUS!";
        else if (moves < 150)
          feedback = "You are a VERY SMART PERSON!";
        else if (moves < 200)
          feedback = "You are a SMART PERSON!";
        else if (moves < 300)
          feedback = "You are DEEPLY AVERAGE!";
        else
          feedback = "Wow you showed great commitment there!";

        setTimeout(() => alert(`🎉 You solved it in ${moves} moves!\n${feedback}`), 100);
      }
    }

    // --- MOVES ELEMENT INITIALIZATION & EVENT BINDINGS ---
    let movesEl;
    let game, newGameBtn;

    window.addEventListener("DOMContentLoaded", () => {
      game = document.getElementById("game");
      newGameBtn = document.getElementById("newGameBtn");
      movesEl = document.getElementById("moves");
      newGameBtn.onclick = scramble;
      scramble();
    });
  </script>
</body>
</html>
